name: Three-Tier Web Application (GCP)
version: 1
provider: gcp
region: us-central1
constraints:
  availability: 99.9
components:
  - id: lb
    service: cloud_load_balancing
    provider: gcp
    label: Cloud Load Balancer
    tier: 1
    config:
      type: external_https
  - id: web
    service: compute_engine
    provider: gcp
    label: Web Servers
    tier: 2
    config:
      machine_type: e2-standard-4
      count: 2
      auto_scaling: true
  - id: cache
    service: memorystore
    provider: gcp
    label: Memorystore Redis
    tier: 3
    config:
      tier: STANDARD_HA
      memory_size_gb: 4
  - id: db
    service: cloud_sql
    provider: gcp
    label: Cloud SQL PostgreSQL
    tier: 3
    config:
      engine: postgresql
      tier: db-custom-4-16384
      high_availability: true
      storage_gb: 100
      encryption: true
      backup: true
connections:
  - source: lb
    target: web
    label: HTTPS traffic
    protocol: HTTPS
    port: 443
  - source: web
    target: cache
    label: Session cache
    protocol: TCP
    port: 6379
  - source: web
    target: db
    label: Database queries
    protocol: TCP
    port: 5432
